import{S as T,j as V,a as q,y as j,T as S,c as $,o as E,r as h,q as B,e as w,f as W,w as d,g as a,l as A,h as v,E as D}from"./vendor-CHjNVy30.js";import{m as J,i as N,s as O,a as R}from"./station-CTe-uNfl.js";import{_ as P}from"./index-CulM0VMq.js";var L={exports:{}},z=L.exports,k;function Z(){return k||(k=1,(function(x,U){(function(m,p){x.exports=p()})(z,function(){function m(o){var u=[];return o.AMapUI&&u.push(p(o.AMapUI)),o.Loca&&u.push(y(o.Loca)),Promise.all(u)}function p(o){return new Promise(function(u,l){var i=[];if(o.plugins)for(var r=0;r<o.plugins.length;r+=1)n.AMapUI.plugins.indexOf(o.plugins[r])==-1&&i.push(o.plugins[r]);if(e.AMapUI===t.failed)l("前次请求 AMapUI 失败");else if(e.AMapUI===t.notload){e.AMapUI=t.loading,n.AMapUI.version=o.version||n.AMapUI.version,r=n.AMapUI.version;var M=document.body||document.head,s=document.createElement("script");s.type="text/javascript",s.src="https://webapi.amap.com/ui/"+r+"/main.js",s.onerror=function(f){e.AMapUI=t.failed,l("请求 AMapUI 失败")},s.onload=function(){if(e.AMapUI=t.loaded,i.length)window.AMapUI.loadUI(i,function(){for(var f=0,b=i.length;f<b;f++){var _=i[f].split("/").slice(-1)[0];window.AMapUI[_]=arguments[f]}for(u();c.AMapUI.length;)c.AMapUI.splice(0,1)[0]()});else for(u();c.AMapUI.length;)c.AMapUI.splice(0,1)[0]()},M.appendChild(s)}else e.AMapUI===t.loaded?o.version&&o.version!==n.AMapUI.version?l("不允许多个版本 AMapUI 混用"):i.length?window.AMapUI.loadUI(i,function(){for(var f=0,b=i.length;f<b;f++){var _=i[f].split("/").slice(-1)[0];window.AMapUI[_]=arguments[f]}u()}):u():o.version&&o.version!==n.AMapUI.version?l("不允许多个版本 AMapUI 混用"):c.AMapUI.push(function(f){f?l(f):i.length?window.AMapUI.loadUI(i,function(){for(var b=0,_=i.length;b<_;b++){var C=i[b].split("/").slice(-1)[0];window.AMapUI[C]=arguments[b]}u()}):u()})})}function y(o){return new Promise(function(u,l){if(e.Loca===t.failed)l("前次请求 Loca 失败");else if(e.Loca===t.notload){e.Loca=t.loading,n.Loca.version=o.version||n.Loca.version;var i=n.Loca.version,r=n.AMap.version.startsWith("2"),M=i.startsWith("2");if(r&&!M||!r&&M)l("JSAPI 与 Loca 版本不对应！！");else{r=n.key,M=document.body||document.head;var s=document.createElement("script");s.type="text/javascript",s.src="https://webapi.amap.com/loca?v="+i+"&key="+r,s.onerror=function(f){e.Loca=t.failed,l("请求 AMapUI 失败")},s.onload=function(){for(e.Loca=t.loaded,u();c.Loca.length;)c.Loca.splice(0,1)[0]()},M.appendChild(s)}}else e.Loca===t.loaded?o.version&&o.version!==n.Loca.version?l("不允许多个版本 Loca 混用"):u():o.version&&o.version!==n.Loca.version?l("不允许多个版本 Loca 混用"):c.Loca.push(function(f){f?l(f):l()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var t;(function(o){o.notload="notload",o.loading="loading",o.loaded="loaded",o.failed="failed"})(t||(t={}));var n={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},e={AMap:t.notload,AMapUI:t.notload,Loca:t.notload},c={AMapUI:[],Loca:[]},I=[],g=function(o){typeof o=="function"&&(e.AMap===t.loaded?o(window.AMap):I.push(o))};return{load:function(o){return new Promise(function(u,l){if(e.AMap==t.failed)l("");else if(e.AMap==t.notload){var i=o.key,r=o.version,M=o.plugins;i?(window.AMap&&location.host!=="lbs.amap.com"&&l("禁止多种API加载方式混用"),n.key=i,n.AMap.version=r||n.AMap.version,n.AMap.plugins=M||n.AMap.plugins,e.AMap=t.loading,r=document.body||document.head,window.___onAPILoaded=function(f){if(delete window.___onAPILoaded,f)e.AMap=t.failed,l(f);else for(e.AMap=t.loaded,m(o).then(function(){u(window.AMap)}).catch(l);I.length;)I.splice(0,1)[0]()},M=document.createElement("script"),M.type="text/javascript",M.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+n.AMap.version+"&key="+i+"&plugin="+n.AMap.plugins.join(","),M.onerror=function(f){e.AMap=t.failed,l(f)},r.appendChild(M)):l("请填写key")}else if(e.AMap==t.loaded)if(o.key&&o.key!==n.key)l("多个不一致的 key");else if(o.version&&o.version!==n.AMap.version)l("不允许多个版本 JSAPI 混用");else{if(i=[],o.plugins)for(r=0;r<o.plugins.length;r+=1)n.AMap.plugins.indexOf(o.plugins[r])==-1&&i.push(o.plugins[r]);i.length?window.AMap.plugin(i,function(){m(o).then(function(){u(window.AMap)}).catch(l)}):m(o).then(function(){u(window.AMap)}).catch(l)}else if(o.key&&o.key!==n.key)l("多个不一致的 key");else if(o.version&&o.version!==n.AMap.version)l("不允许多个版本 JSAPI 混用");else{var s=[];if(o.plugins)for(r=0;r<o.plugins.length;r+=1)n.AMap.plugins.indexOf(o.plugins[r])==-1&&s.push(o.plugins[r]);g(function(){s.length?window.AMap.plugin(s,function(){m(o).then(function(){u(window.AMap)}).catch(l)}):m(o).then(function(){u(window.AMap)}).catch(l)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,n={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},e={AMap:t.notload,AMapUI:t.notload,Loca:t.notload},c={AMap:[],AMapUI:[],Loca:[]}}}})})(L)),L.exports}var F=Z();const G=T(F),H={id:"container"},K=V({__name:"MapContain",props:{refreshToken:{}},setup(x){const U=x;let m=null,p=null;const y=[];async function t(){if(m){for(;y.length;){const n=y.pop();try{n.setMap&&n.setMap(null)}catch{}}try{const{data:n}=await J();console.log("地图数据",n),n.forEach(e=>{const c=new p.Marker({position:e.position,title:e.title,icon:N});c.on("click",()=>{new p.InfoWindow({content:`<div style="display:flex;padding:10px;align-items:center">
                <div><img src="${O}" width="200px"/></div>
                <div style="width:180px;line-height:30px;margin-left:20px">
                    <h3>${e.title}</h3>
                    <p>充电桩数量：${e.count}</p>
                    <p>充电站状态：<span style="color:blue">${e.status==1?"使用中":"维护中"}</span></p>
                </div>
              </div>`,offset:new p.Pixel(0,-30)}).open(m,c.getPosition())}),c.setMap(m),y.push(c)})}catch(n){console.error("loadMarkers error",n)}}}return q(()=>{G.load({key:"c4b0f8db6005f25720d601159b3699cc",version:"1.4.15",plugins:[]}).then(n=>{p=n,m=new n.Map("container",{viewMode:"3D",zoom:6});try{m.setZoomAndCenter(6,[116.397428,39.90923])}catch{try{m.setZoom(6),m.setCenter([116.397428,39.90923])}catch{}}t(),setTimeout(()=>{window.dispatchEvent(new Event("resize"))},50)}).catch(n=>{console.error(n)})}),j(()=>U.refreshToken,(n,e)=>{console.log("refreshToken changed",n,e),n!==e&&t()}),S(()=>{try{y.forEach(n=>n.setMap&&n.setMap(null))}catch{}m?.destroy()}),(n,e)=>(E(),$("div",H))}}),Q=P(K,[["__scopeId","data-v-03c0bead"]]),X=V({__name:"ElectronicMap",setup(x){const U=h(),m=h(0),p=h({name:"",region:"",location1:"",location2:"",now:"",remarks:"",title:""}),y=B({name:[{required:!0,message:"请输入站点名称",trigger:"blur"}],region:[{required:!0,message:"请输入站点地址",trigger:"blur"}],location1:[{required:!0,message:"请输入经度",trigger:"blur"}],location2:[{required:!0,message:"请输入维度",trigger:"blur"}]}),t=()=>{U.value?.validate(async n=>{if(n){p.value.title=p.value.name;const e=await R(p.value);console.log("res",e),e.code==200&&(p.value={name:"",region:"",location1:"",location2:"",now:"",remarks:"",title:""},m.value+=1,D({message:e.data,type:"success"}))}else console.log("error submit!!")})};return(n,e)=>{const c=w("el-card"),I=w("el-col"),g=w("el-text"),o=w("el-input"),u=w("el-form-item"),l=w("el-switch"),i=w("el-button"),r=w("el-form"),M=w("el-row");return E(),W(M,{gutter:20},{default:d(()=>[a(I,{span:18},{default:d(()=>[a(c,null,{default:d(()=>[a(Q,{refreshToken:m.value},null,8,["refreshToken"])]),_:1})]),_:1}),a(I,{span:6},{default:d(()=>[a(c,{class:"des"},{default:d(()=>[A("div",null,[e[7]||(e[7]=v("1.累计充电站数量：",-1)),a(g,{type:"primary"},{default:d(()=>[...e[6]||(e[6]=[v("34个",-1)])]),_:1})]),A("div",null,[e[9]||(e[9]=v(" 2.单省份最多充电桩：",-1)),a(g,{type:"primary"},{default:d(()=>[...e[8]||(e[8]=[v("北京(4个)",-1)])]),_:1})]),A("div",null,[e[11]||(e[11]=v("3.充电站遍及省份：",-1)),a(g,{type:"primary"},{default:d(()=>[...e[10]||(e[10]=[v("14个",-1)])]),_:1})]),A("div",null,[e[13]||(e[13]=v("4.暂无充电站省份：",-1)),a(g,{type:"primary"},{default:d(()=>[...e[12]||(e[12]=[v("22个",-1)])]),_:1})]),A("div",null,[e[15]||(e[15]=v("5.累计充电站：",-1)),a(g,{type:"primary"},{default:d(()=>[...e[14]||(e[14]=[v("北京(4个)",-1)])]),_:1})]),A("div",null,[e[17]||(e[17]=v(" 6.单日营收最高：",-1)),a(g,{type:"primary"},{default:d(()=>[...e[16]||(e[16]=[v("北京西单充电站",-1)])]),_:1})]),A("div",null,[e[19]||(e[19]=v(" 7.单日营收最低：",-1)),a(g,{type:"primary"},{default:d(()=>[...e[18]||(e[18]=[v("南宁青秀山充电站",-1)])]),_:1})]),A("div",null,[e[21]||(e[21]=v(" 8.故障率最高：",-1)),a(g,{type:"primary"},{default:d(()=>[...e[20]||(e[20]=[v("兰州黄河桥充电站",-1)])]),_:1})])]),_:1}),a(c,{class:"mt"},{header:d(()=>[...e[22]||(e[22]=[A("div",{class:"card-header"},[A("h3",null,"新增站点地图")],-1)])]),default:d(()=>[a(r,{model:p.value,rules:y,style:{"max-width":"600px"},"label-width":"100px",ref_key:"formRef",ref:U},{default:d(()=>[a(u,{label:"站点名称：",prop:"name"},{default:d(()=>[a(o,{placeholder:"请输入站点名称",modelValue:p.value.name,"onUpdate:modelValue":e[0]||(e[0]=s=>p.value.name=s)},null,8,["modelValue"])]),_:1}),a(u,{label:"站点地址",prop:"region"},{default:d(()=>[a(o,{placeholder:"请输入站点地址",modelValue:p.value.region,"onUpdate:modelValue":e[1]||(e[1]=s=>p.value.region=s)},null,8,["modelValue"])]),_:1}),a(u,{label:"经度：",prop:"location1"},{default:d(()=>[a(o,{placeholder:"请输入经度",modelValue:p.value.location1,"onUpdate:modelValue":e[2]||(e[2]=s=>p.value.location1=s)},null,8,["modelValue"])]),_:1}),a(u,{label:"维度：",prop:"location2"},{default:d(()=>[a(o,{placeholder:"请输入维度",modelValue:p.value.location2,"onUpdate:modelValue":e[3]||(e[3]=s=>p.value.location2=s)},null,8,["modelValue"])]),_:1}),a(u,{label:"立即使用：",prop:"now"},{default:d(()=>[a(l,{modelValue:p.value.now,"onUpdate:modelValue":e[4]||(e[4]=s=>p.value.now=s)},null,8,["modelValue"])]),_:1}),a(u,{label:"备注",prop:"remarks"},{default:d(()=>[a(o,{placeholder:"请输入备注",type:"textarea",modelValue:p.value.remarks,"onUpdate:modelValue":e[5]||(e[5]=s=>p.value.remarks=s)},null,8,["modelValue"])]),_:1}),a(u,null,{default:d(()=>[a(i,{type:"primary",onClick:t},{default:d(()=>[...e[23]||(e[23]=[v("创建",-1)])]),_:1}),a(i,null,{default:d(()=>[...e[24]||(e[24]=[v("清空",-1)])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})]),_:1})}}}),ne=P(X,[["__scopeId","data-v-f5d524c6"]]);export{ne as default};
