import{p as b,u as N}from"./index-BJQUWR-1.js";import{j as M,r as m,x as R,e as n,f as S,o as D,w as o,g as t,l as u,h as y,E}from"./vendor-CHjNVy30.js";function k(l){return l.map(s=>{const a={label:s.name,url:s.url};return s.children&&(a.children=k(s.children)),a})}const A={auth:"/userAuth",setAuth:"/setAuth"},j=l=>b(A.auth,{pageAuthority:l}),O=(l,s,a)=>b(A.setAuth,{account:l,btnList:s,pageList:a}),T={class:"dialog-footer"},z=M({__name:"AuthModal",props:{visible:{type:Boolean,required:!0},checkedKeys:{type:Array,required:!0},btnAuth:{type:Array,required:!0},account:{type:String,required:!0}},emits:["close","reload"],setup(l,{emit:s}){const a=l,c=m([]),g=N(),{menu:x}=R(g),r=m(),p=s,h=m(k(x.value));console.log(h.value,"treeData");const C=()=>{r.value&&r.value.setCheckedKeys&&r.value.setCheckedKeys(a.checkedKeys),c.value=a.btnAuth},w=()=>{p("close")},V=async()=>{const d=await O(a.account,r.value.getCheckedKeys(!0),c.value);d.code==200&&(E({message:d.message,type:"success"}),p("close"),p("reload"))};return(d,e)=>{const B=n("el-tree"),f=n("el-card"),i=n("el-checkbox"),K=n("el-checkbox-group"),v=n("el-button"),q=n("el-dialog");return D(),S(q,{title:"权限设置",width:"600px","model-value":l.visible,onClose:w,onOpen:C},{footer:o(()=>[u("div",T,[t(v,{onClick:e[1]||(e[1]=_=>d.$emit("close"))},{default:o(()=>[...e[4]||(e[4]=[y("取消",-1)])]),_:1}),t(v,{type:"primary",onClick:V},{default:o(()=>[...e[5]||(e[5]=[y(" 确认 ",-1)])]),_:1})])]),default:o(()=>[t(f,null,{header:o(()=>[...e[2]||(e[2]=[u("div",{class:"card-header"},[u("span",null,"页面权限")],-1)])]),default:o(()=>[t(B,{data:h.value,style:{"max-width":"600px"},"show-checkbox":"","node-key":"url",ref_key:"treeRef",ref:r},null,8,["data"])]),_:1}),t(f,{class:"mt"},{header:o(()=>[...e[3]||(e[3]=[u("div",{class:"card-header"},[u("span",null,"按钮权限")],-1)])]),default:o(()=>[t(K,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=_=>c.value=_),class:"mt"},{default:o(()=>[t(i,{label:"全部",value:"all"}),t(i,{label:"添加",value:"add"}),t(i,{label:"编辑",value:"edit"}),t(i,{label:"删除",value:"delete"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model-value"])}}});export{z as _,j as g};
