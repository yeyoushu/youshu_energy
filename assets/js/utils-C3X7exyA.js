const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/symbolLayerUtils-DZVNE9jl.js","assets/js/index-BJQUWR-1.js","assets/js/vendor-CHjNVy30.js","assets/css/index-xCubpQZP.css","assets/js/test-DMnSxVQs.js","assets/js/station-DfQHTTxy.js","assets/css/test-D2ol9zJk.css","assets/js/LRUCache--7okbBjw.js","assets/js/MemCache-CYsUaMUi.js"])))=>i.map(i=>d[i]);
import{a as w}from"./index-BJQUWR-1.js";import{r as a,hc as y,hd as m,he as d,hf as k,hg as g}from"./test-DMnSxVQs.js";import{u as L}from"./cimSymbolUtils-DevxqcTH.js";import{e as z}from"./LRUCache--7okbBjw.js";import"./defaultCIMValues-eS1WuCTt.js";new z(1e3);new a([128,128,128]);const j=new a("white");function T(o){if(o==null||!("symbolLayers"in o)||o.symbolLayers==null)return!1;switch(o.type){case"point-3d":return o.symbolLayers.some((n=>n.type==="object"));case"line-3d":return o.symbolLayers.some((n=>n.type==="path"));case"polygon-3d":return o.symbolLayers.some((n=>n.type==="object"||n.type==="extrude"));default:return!1}}function U(o){return o.resource?.href??""}function V(o,n){if(!o)return null;let r=null;return y(o)?r=x(o):m(o)&&(r=o.type==="cim"?L(o):o.color?new a(o.color):null),r?f(r,n):null}function x(o){const n=o.symbolLayers;if(!n)return null;let r=null;return n.forEach((t=>{t.type==="object"&&t.resource?.href||(r=t.type==="water"?t.color:t.material?t.material.color:null)})),r?new a(r):null}function f(o,n){if(n==null||o==null)return o;const r=o.toRgba();return r[3]=r[3]*n,new a(r)}function _(o,n,r){const t=o.symbolLayers;if(!t)return;const e=l=>f(n??l??(r!=null?j:null),r);t.forEach((l=>{if(l.type!=="object"||!l.resource?.href||n)if(l.type==="water")l.color=e(l.color);else{const c=l.material!=null?l.material.color:null,u=e(c);if(l.material==null?l.material=new d({color:u}):l.material.color=u,r!=null&&"outline"in l&&l.outline?.color!=null&&(l.outline.color=f(l.outline.color,r)),"marker"in l&&l.marker!=null){const i=e(l.marker.color);l.marker.color=i}}}))}function v(o,n,r){(n=n??o.color)&&(o.color=f(n,r)),r!=null&&"outline"in o&&o.outline?.color&&(o.outline.color=f(o.outline.color,r))}function q(o,n,r){o&&(n||r!=null)&&(n&&(n=new a(n)),y(o)?_(o,n,r):m(o)&&v(o,n,r))}async function S(o,n){const r=o.symbolLayers;r&&await k(r,(async t=>E(t,n)))}async function E(o,n){switch(o.type){case"extrude":$(o,n);break;case"icon":case"line":case"text":R(o,n);break;case"path":A(o,n);break;case"object":await O(o,n)}}function R(o,n){const r=p(n);r!=null&&(o.size=r)}function p(o){for(const n of o)if(typeof n=="number")return n;return null}function $(o,n){const r=n[2];typeof r=="number"&&(o.size=r)}async function O(o,n){const{resourceSize:r,symbolSize:t}=await D(o),e=b(n,r,t);e!=null&&(o.width=s(n[0],t[0],r[0],e),o.depth=s(n[1],t[1],r[1],e),o.height=s(n[2],t[2],r[2],e))}function A(o,n){const r=b(n,g,[o.width,void 0,o.height]);r!=null&&(o.width=s(n[0],o.width,1,r),o.height=s(n[2],o.height,1,r))}function b(o,n,r){for(let t=0;t<3;t++){const e=o[t];switch(e){case"symbol-value":{const l=r[t];return l!=null?l/n[t]:1}case"proportional":break;default:if(e&&n[t])return e/n[t]}}return null}async function D(o){const{computeObjectLayerResourceSize:n}=await w(()=>import("./symbolLayerUtils-DZVNE9jl.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])),r=await n(o,10),{width:t,height:e,depth:l}=o,c=[t,l,e];let u=1;for(let i=0;i<3;i++){const h=c[i];if(h!=null){u=h/r[i];break}}for(let i=0;i<3;i++)c[i]==null&&(c[i]=r[i]*u);return{resourceSize:r,symbolSize:c}}function s(o,n,r,t){switch(o){case"proportional":return r*t;case"symbol-value":return n??r;default:return o}}function P(o,n){const r=p(n);if(r!=null)switch(o.type){case"simple-marker":o.size=r;break;case"picture-marker":{const t=o.width/o.height;t>1?(o.width=r,o.height=r*t):(o.width=r*t,o.height=r);break}case"simple-line":o.width=r;break;case"text":o.font.size=r}}async function B(o,n){if(o&&n)return y(o)?S(o,n):void(m(o)&&P(o,n))}function F(o,n,r){if(o&&n!=null)if(y(o)){const t=o.symbolLayers;t&&t.forEach((e=>{if(e.type==="object")switch(r){case"tilt":e.tilt=(e.tilt??0)+n;break;case"roll":e.roll=(e.roll??0)+n;break;default:e.heading=(e.heading??0)+n}e.type==="icon"&&(e.angle+=n)}))}else m(o)&&(o.type!=="simple-marker"&&o.type!=="picture-marker"&&o.type!=="text"||(o.angle+=n))}function G(o){return o!=null&&o.type==="polygon-3d"&&o.symbolLayers.some((n=>n.type==="extrude"))}export{G as A,q as L,B as M,F as N,U as b,T as h,V as w};
